import{h as v,c as N,g as u,r as c,A as C,j as e,D as w,U as P,f as U,R as h}from"./index-uGkR4gBj.js";import{P as M}from"./Pagination--G9jvU4M.js";import{C as k,T as A}from"./ConfirmDialog-buWWrIj0.js";async function L(t,s){t=t||10,s=s||0;let a=await v.get("/api/v1/user",{params:{limit:t,offset:s}});if(a.status!==200)throw Error("failed to get problem list");return a.data}const S=()=>{const t=N(),{t:s}=u(),[a,n]=c.useState([]),[o,l]=c.useState(0),[i,m]=c.useState(10),[d,j]=c.useState(0);c.useEffect(()=>{L(i,d).then(r=>{n(r.list),l(r.total)}).catch(r=>{t({type:C,payload:{id:"user-list-fetch-error",content:`${s("Failed to fetch user list")}`,duration:3e3,level:"error",err:r.toString()}})})},[t,i,d,s]);function g(){return a}function b(r){return Math.ceil(o/r)}function f(r,p){m(r),j(p)}return{getUserInfoList:g,getPageCount:b,setPagenation:f}},D=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:w,strokeLinecap:"round",strokeLinejoin:"round",className:t.className,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0"}),e.jsx("path",{d:"M6 21v-2a4 4 0 0 1 4 -4h2.5"}),e.jsx("path",{d:"M19.001 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),e.jsx("path",{d:"M19.001 15.5v1.5"}),e.jsx("path",{d:"M19.001 21v1.5"}),e.jsx("path",{d:"M22.032 17.25l-1.299 .75"}),e.jsx("path",{d:"M17.27 20l-1.3 .75"}),e.jsx("path",{d:"M15.97 17.25l1.3 .75"}),e.jsx("path",{d:"M20.733 20l1.3 .75"})]}),y=t=>{const{t:s}=u();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t.className,children:e.jsxs("table",{className:"table","aria-label":"Problem Table",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-base-content/10",children:[e.jsx("th",{children:s("Avatar")},"avatar"),e.jsx("th",{children:s("Name")},"name"),e.jsx("th",{children:s("Account")},"account"),e.jsx("th",{children:s("Roles")},"roles"),t.showActions&&e.jsx("th",{children:s("Actions")},"actions")]})}),e.jsx("tbody",{children:t.data.map(a=>e.jsxs("tr",{className:"border-base-content/10",children:[e.jsx("td",{className:"flex items-center gap-3 py-2",children:e.jsx("div",{className:"avatar",children:e.jsx(P,{alt:a.name,avatarUrl:a.avatarUrl})})}),e.jsx("th",{children:a.name}),e.jsx("td",{children:a.account}),e.jsx("td",{children:e.jsx(T,{roles:a.roles??[]})}),t.showActions&&e.jsx("td",{className:"p-2",children:e.jsx(E,{userInfo:a,onClickDelete:()=>{}})})]},a.account))})]})}),e.jsx(k,{id:"user_delete_confirm_modal",title:"Confirm",message:"Are you sure to delete this user?",onClickConfirm:()=>{window.location.reload()}})]})},T=t=>t.roles===void 0?e.jsx(e.Fragment,{}):e.jsx("div",{className:"space-x-2",children:t.roles.map(s=>e.jsx("div",{className:"badge border-0 bg-base-300 font-semibold text-base-content/80",children:s},s))}),E=t=>{var a;const s=n=>{n.preventDefault(),n.stopPropagation(),t.onClickDelete();const o=document.getElementById("delete_confirm_modal");o==null||o.showModal()};return e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{className:"btn btn-square btn-ghost btn-sm rounded",children:e.jsx(D,{className:U("h-5 w-5",(a=t.userInfo.roles)!=null&&a.includes("admin")?"text-success":"text-base-content")})}),e.jsx("button",{className:"btn btn-square btn-ghost btn-sm rounded hover:bg-error/20",onClick:s,children:e.jsx(A,{className:"h-5 w-5 text-error"})})]})},x=[10,25,50],F=()=>{const{getUserInfoList:t,getPageCount:s,setPagenation:a}=S(),[n,o]=h.useState(x[0]),[l,i]=h.useState(0);return c.useEffect(()=>{a(n,l*n)},[n,l]),e.jsxs("div",{className:"card card-bordered flex w-full flex-col rounded border-base-content/10 bg-base-100",children:[e.jsx(y,{data:t(),showActions:!0,className:t().length===1?"":"border-b border-base-content/10"}),e.jsx(M,{page:l,pageCount:s(n),setCountPerPage:o,countPerPage:n,countPerPageSelections:x,setPage:i})]})};export{F as default};
